% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[
  a4paper,
]{article}
\usepackage{amsmath,amssymb}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math} % this also loads fontspec
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
\usepackage{lmodern}
\ifPDFTeX\else
  % xetex/luatex font selection
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\usepackage[margin=1in]{geometry}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{-\maxdimen} % remove section numbering
% definitions for citeproc citations
\NewDocumentCommand\citeproctext{}{}
\NewDocumentCommand\citeproc{mm}{%
  \begingroup\def\citeproctext{#2}\cite{#1}\endgroup}
\makeatletter
 % allow citations to break across lines
 \let\@cite@ofmt\@firstofone
 % avoid brackets around text for \cite:
 \def\@biblabel#1{}
 \def\@cite#1#2{{#1\if@tempswa , #2\fi}}
\makeatother
\newlength{\cslhangindent}
\setlength{\cslhangindent}{1.5em}
\newlength{\csllabelwidth}
\setlength{\csllabelwidth}{3em}
\newenvironment{CSLReferences}[2] % #1 hanging-indent, #2 entry-spacing
 {\begin{list}{}{%
  \setlength{\itemindent}{0pt}
  \setlength{\leftmargin}{0pt}
  \setlength{\parsep}{0pt}
  % turn on hanging indent if param 1 is 1
  \ifodd #1
   \setlength{\leftmargin}{\cslhangindent}
   \setlength{\itemindent}{-1\cslhangindent}
  \fi
  % set entry spacing
  \setlength{\itemsep}{#2\baselineskip}}}
 {\end{list}}
\usepackage{calc}
\newcommand{\CSLBlock}[1]{\hfill\break\parbox[t]{\linewidth}{\strut\ignorespaces#1\strut}}
\newcommand{\CSLLeftMargin}[1]{\parbox[t]{\csllabelwidth}{\strut#1\strut}}
\newcommand{\CSLRightInline}[1]{\parbox[t]{\linewidth - \csllabelwidth}{\strut#1\strut}}
\newcommand{\CSLIndent}[1]{\hspace{\cslhangindent}#1}
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{booktabs}
\usepackage{multirow}
\newtheorem{definition}{Definition}
\DeclareMathOperator*{\argmax}{argmax}
\DeclareMathOperator*{\argmin}{argmin}
\DeclareMathOperator{\sgn}{sgn}
\ifLuaTeX
  \usepackage{selnolig}  % disable illegal ligatures
\fi
\usepackage{bookmark}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\urlstyle{same}
\hypersetup{
  pdftitle={Appendix},
  pdfauthor={Alex Zwanenburg, Steffen Löck},
  hidelinks,
  pdfcreator={LaTeX via pandoc}}

\title{Appendix}
\author{Alex Zwanenburg, Steffen Löck}
\date{2025-03-27}

\begin{document}
\maketitle

\section{Appendix A: Log-likelihood functions for location and scale
invariant power
transformation}\label{appendix-a-log-likelihood-functions-for-location-and-scale-invariant-power-transformation}

Location and scale-invariant Box-Cox and Yeo-Johnson transformations are
parametrised using location \(x_0\) and scale \(s\) parameters, in
addition to transformation parameter \(\lambda\). This leads to the
following transformations. The location and scale-invariant Box-Cox
transformation is:

\begin{equation}
\phi_{\text{BC}}^{\lambda, x_0, s} (x_i) = 
\begin{cases}
\left( \left(\frac{x_i - x_0}{s} \right)^\lambda - 1 \right) / \lambda & \text{if } \lambda \neq 0\\
\log\left[\frac{x_i - x_0}{s}\right] & \text{if } \lambda = 0
\end{cases}
\end{equation}

where \(x_i - x_0 > 0\). The location and scale-invariant Yeo-Johnson
transformation is:

\begin{equation}
\phi_{\text{YJ}}^{\lambda, x_0, s} (x_i) = 
\begin{cases}
\left( \left( 1 + \frac{x_i - x_0}{s}\right)^\lambda - 1\right) / \lambda & \text{if } \lambda \neq 0 \text{ and } x_i - x_0 \geq 0\\
\log\left[1 + \frac{x_i - x_0}{s}\right] & \text{if } \lambda = 0 \text{ and } x_i - x_0 \geq 0\\
-\left( \left( 1 - \frac{x_i - x_0}{s}\right)^{2 - \lambda} - 1 \right) / \left(2 - \lambda \right) & \text{if } \lambda \neq 2 \text{ and } x_i - x_0 < 0\\
-\log\left[1 - \frac{x_i - x_0}{s}\right] & \text{if } \lambda = 2 \text{ and } x_i - x_0 < 0
\end{cases}
\end{equation}

The parameters of these power transformations can be optimised based by
maximising the log-likelihood function, under the assumption that the
transformed feature \(\phi^{\lambda, x_0, s} (\mathbf{X})\) follows a
normal distribution. The log-likelihood functions for conventional
Box-Cox and Yeo-Johnson transformations are well-known. However, the
introduction of scaling parameter \(s\) prevents their direct use. Here,
we first derive the general form of the log-likelihood functions, and
then derive their power-transformation specific definitions.

Let \(f(x_1, \ldots, x_n)\) be the probability density function of
feature \(\mathbf{X} = \{ x_1, \ldots, x_n\}\), and
\(f^{\lambda, x_0, s} (\phi^{\lambda, x_0, s}(x_1), \ldots, \phi^{\lambda, x_0, s}(x_n))\)
be the probability density function of the transformed feature
\(\phi^{\lambda, x_0, s} (\mathbf{X})\), that is assumed to follow a
normal distribution.

The two probability density functions are related as follows:

\begin{equation}
f^{\lambda, x_0, s}(x_1, \ldots, x_n) = f^{\lambda, x_0, s} (\phi^{\lambda, x_0, s}(x_1), \ldots, \phi^{\lambda, x_0, s}(x_n)) \left|\mathbf{J}\right|
\end{equation}

Where, \(\left|\mathbf{J}\right|\) is the determinant of Jacobian
\(\mathbf{J}\). The Jacobian takes the following form, with off-diagonal
elements \(0\):

\begin{equation}
\mathbf{J} =
\begin{bmatrix}
    \frac{\partial}{\partial x_1} \phi^{\lambda, x_0, s}(x_1) & 0 & \dots & 0 \\
    0 & \frac{\partial}{\partial x_2} \phi^{\lambda, x_0, s}(x_2) & \dots & 0 \\
    \vdots & \vdots  & \ddots &  \vdots \\
    0  & 0 & 0 & \frac{\partial}{\partial x_n} \phi^{\lambda, x_0, s}(x_n)
\end{bmatrix}
\end{equation}

Thus,
\(\left| \mathbf{J} \right| = \prod_{i=1}^n \frac{\partial}{\partial x_i} \phi^{\lambda, x_0, s}(x_i)\).

Since in our situation \(\{x_1, \ldots, x_n\}\) in
\(f^{\lambda, x_0, s}(x_1, \ldots, x_n)\) are considered fixed (i.e.,
known), \(f^{\lambda, x_0, s}(x_1, \ldots, x_n)\) may be considered a
likelihood function. The log-likelihood function
\(\mathcal{l}^{\lambda, x_0, s}\) is then:

\begin{equation}
\begin{split}
\mathcal{l}^{\lambda, x_0, s} & = \log f^{\lambda, x_0, s}(x_1, \ldots, x_n) \\
 & = \log \left[ f^{\lambda, x_0, s} (\phi^{\lambda, x_0, s}(x_1), \ldots, \phi^{\lambda, x_0, s}(x_n)) \right] + \log \left|\mathbf{J}\right| \\
 & = \log \left[ f^{\lambda, x_0, s} (\phi^{\lambda, x_0, s}(x_1), \ldots, \phi^{\lambda, x_0, s}(x_n)) \right] + \log \prod_{i=1}^n \frac{\partial}{\partial x_i} \phi^{\lambda, x_0, s}(x_i) \\
 & = -\frac{n}{2} \log \left[2 \pi \sigma^2 \right] -\frac{1}{2 \sigma^2} \sum_{i=1}^n \left( \phi^{\lambda, x_0, s}(x_i) - \mu \right)^2 + \sum_{i=1}^n \log \left[ \frac{\partial}{\partial x_i} \phi^{\lambda, x_0, s}(x_i)\right]
\end{split}
\end{equation}

With \(\mu\) the average of \(\phi^{\lambda, x_0, s}(\mathbf{X})\) and
\(\sigma^2\) its variance. The first two terms derive directly from the
log-likelihood function of a normal distribution, and are not specific
to the type of power transformation used. However, the final term
differs between Box-Cox and Yeo-Johnson transformations.

\subsection{Location- and scale-invariant Box-Cox
transformation}\label{location--and-scale-invariant-box-cox-transformation}

For the location- and scale-invariant Box-Cox transformation the partial
derivative is:

\begin{equation}
\begin{split}
\frac{\partial}{\partial x_i} \phi_{\text{BC}}^{\lambda, x_0, s}(x_i) & = \frac{1}{s} \left(\frac{x_i - x_0}{s} \right)^{\lambda-1} \\
 & = \frac{1} {s^\lambda} \left(x_i - x_0 \right)^{\lambda - 1}
\end{split}
\end{equation}

Thus the final term in \(\mathcal{l}_{\text{BC}}^{\lambda, x_0, s}\) is:

\begin{equation}
\begin{split}
\sum_{i=1}^n \log \frac{\partial}{\partial x_i} \phi_{\text{BC}}^{\lambda, x_0, s}(x_i) & = \sum_{i=1}^n \log \left[ s^{-\lambda} (x_i - x_0)^{\lambda - 1} \right] \\
& = \sum_{i=1}^n \log \left[s^{-\lambda} \right] + \log \left[ (x_i - x_0)^{\lambda - 1} \right]\\
& = -n \lambda \log s + \left( \lambda - 1 \right) \sum_{i=1}^n \log \left[ x_i - x_0 \right]
\end{split}
\end{equation}

This leads to the following log-likelihood:

\begin{equation}
\begin{split}
\mathcal{l}_{\text{BC}}^{\lambda, x_0, s} = & -\frac{n}{2} \log \left[2 \pi \sigma^2 \right] -\frac{1}{2 \sigma^2} \sum_{i=1}^n \left( \phi^{\lambda, x_0, s}(x_i) - \mu \right)^2 \\
& -n \lambda \log s + \left( \lambda - 1 \right) \sum_{i=1}^n \log \left[ x_i - x_0 \right]
\end{split}
\end{equation}

Similarly to Raymaekers and Rousseeuw (2024), sample weights \(w_i\) are
introduced to facilitate robust power transformations. The weighted
log-likelihood of the location- and scale-invariant Box-Cox
transformation is:

\begin{equation}
\begin{split}
\mathcal{l}_{\text{rBC}}^{\lambda, x_0, s} = & -\frac{1}{2} \left(\sum_{i=1}^n w_i \right) \log \left[ 2 \pi \sigma_w^2 \right] -\frac{1}{2 \sigma_w^2} \sum_{i=1}^n w_i \left( \phi^{\lambda, x_0, s}(x_i) - \mu_w \right)^2 \\
& - \lambda \left( \sum_{i=1}^n w_i \right) \log s + \left( \lambda - 1 \right) \sum_{i=1}^n w_i \log \left[ x_i - x_0 \right]
\end{split}
\end{equation}

where \(\mu_w\) and \(\sigma^2_w\) are the weighted mean and weighted
variance of the Box-Cox transformed feature
\(\phi_{\text{BC}}^{\lambda, x_0, s} (\mathbf{X})\), respectively:

\begin{equation}
\sigma_w^2 = \frac{\sum_{i=1}^n w_i \left(\phi_{\text{BC}}^{\lambda, x_0, s} (x_i) - \mu_w \right)^2}{\sum_{i=1}^n w_i} \quad \text{with } \mu_w = \frac{\sum_{i=1}^n \phi_{\text{BC}}^{\lambda, x_0, s} (x_i)} {\sum_{i=1}^n w_i}
\end{equation}

\subsection{Location- and scale-invariant Yeo-Johnson
transformation}\label{location--and-scale-invariant-yeo-johnson-transformation}

For the location- and scale-invariant Yeo-Johnson transformation, the
partial derivative is:

\begin{equation}
\frac{\partial}{\partial x_i} \phi_{\text{YJ}}^{\lambda, x_0, s}(x_i) =
\begin{cases}
\frac{1}{s} \left(1 + \frac{x_i - x_0}{s}\right)^{\lambda - 1} & \text{if } x_i - x_0 \geq 0\\
\frac{1}{s} \left(1 - \frac{x_i - x_0}{s}\right)^{1 - \lambda} & \text{if } x_i - x_0 < 0
\end{cases}
\end{equation}

Thus the final term in \(\mathcal{l}_{\text{YJ}}^{\lambda, x_0, s}\) is:

\begin{equation}
\begin{split}
\sum_{i=1}^n \log \frac{\partial}{\partial x_i} \phi_{\text{YJ}}^{\lambda, x_0, s}(x_i) & = - n \log s + (\lambda - 1) \sum_{i=1}^n \sgn(x_i - x_0) \log \left[1 + \frac{|x_i - x_0|}{s} \right]
\end{split}
\end{equation}

This leads to the following log-likelihood:

\begin{equation}
\begin{split}
\mathcal{l}_{\text{YJ}}^{\lambda, x_0, s} = & -\frac{n}{2} \log\left[2 \pi \sigma^2\right] -\frac{1}{2 \sigma^2} \sum_{i=1}^n \left( \phi^{\lambda, x_0, s}(x_i) - \mu \right)^2 \\
& - n \log s + (\lambda - 1) \sum_{i=1}^n \sgn(x_i - x_0) \log \left[1 + \frac{|x_i - x_0|}{s} \right]
\end{split}
\end{equation}

The weighted log-likelihood for location- and scale-invariant
Yeo-Johnson transformation is:

\begin{equation}
\begin{split}
\mathcal{l}_{\text{rYJ}}^{\lambda, x_0, s} = & -\frac{1}{2} \left(\sum_{i=1}^n w_i \right) \log \left[ 2 \pi \sigma_w^2 \right] -\frac{1}{2 \sigma_w^2} \sum_{i=1}^n w_i \left( \phi^{\lambda, x_0, s}(x_i) - \mu_w \right)^2 \\
& - \left( \sum_{i=1}^n w_i \right) \log s + (\lambda - 1) \sum_{i=1}^n w_i \sgn(x_i - x_0) \log \left[1 + \frac{|x_i - x_0|}{s} \right]
\end{split}
\end{equation}

where \(\mu_w\) and \(\sigma^2_w\) are the weighted mean and weighted
variance of the Yeo-Johnson transformed feature
\(\phi_{\text{YJ}}^{\lambda, x_0, s} (\mathbf{X})\):

\begin{equation}
\sigma_w^2 = \frac{\sum_{i=1}^n w_i \left(\phi_{\text{YJ}}^{\lambda, x_0, s} (x_i) - \mu_w \right)^2}{\sum_{i=1}^n w_i} \quad \text{with } \mu_w = \frac{\sum_{i=1}^n \phi_{\text{YJ}}^{\lambda, x_0, s} (x_i)} {\sum_{i=1}^n w_i}
\end{equation}

\section{Appendix B: Optimisation of transformation
parameters}\label{appendix-b-optimisation-of-transformation-parameters}

Maximum likelihood estimation (MLE) is commonly used to optimise
parameters for power transformation. Generally, optimisation requires
minimisation or maximisation of a criterion. In MLE, the maximised
criterion is the log-likelihood function of the normal distribution.
Here, we investigate power transformation using optimisation criteria
that are closely related to test statistics for normality tests.

Let \(\mathbf{X}\) be a feature with ordered feature values, and
\(\mathbf{Y}^\lambda =\phi^{\lambda} \left(\mathbf{X} \right)\) and
\(\mathbf{Y}^{\lambda, x_0, s} =\phi^{\lambda, x_0, s} \left(\mathbf{X} \right)\)
its transformed values using conventional and shift and scale invariant
power transformations, respectively. Since power transformations are
monotonic, \(\mathbf{Y}\) will likewise be ordered.

Below we will focus on criteria based on the empirical density function
and those based on skewness and kurtosis of the transformed featured.
Other potential criteria, such as the Shapiro-Wilk test statistic
(Shapiro and Wilk 1965) are not investigated here. In the case of the
Shapiro-Wilk test statistic this is because of lack of scalability to
features with many (\(> 5000\)) instances, and because adapting the test
statistic to include weights is not straightforward.

\subsection{Empirical density function-based
criteria}\label{empirical-density-function-based-criteria}

The first class of criteria is based on the empirical distribution
function (EDF). Transformation parameters are then fit through
minimisation of the distance between the empirical distribution function
\(F_{\epsilon}\) and the cumulative density function (CDF) of the normal
distribution \(F_{\mathcal{N}}\). Let
\(F_{\epsilon}\left(x_i \right) = \frac{i - 1/3}{n + 1/3}\) be the
empirical probability of instance \(i\). The normal distribution is
parametrised by location parameter \(\mu\) and scale parameter
\(\sigma\), both of which have to be estimated from the data. For
non-robust power transformations, \(\mu\) and \(\sigma\) are sample mean
and sample standard deviation, respectively. For robust power
transformations, we estimate \(\mu\) and \(\sigma\) as Huber M-estimates
of location and scale of the transformed feature
\(\phi^{\lambda, x_0, s} (\mathbf{X})\) (Huber 1981).

\subsubsection{Anderson-Darling
criterion}\label{anderson-darling-criterion}

The Anderson-Darling criterion is based on the empirical distribution
function of \(\mathbf{X}\). We define this criterion as follows:

\begin{equation}
U_{\text{AD}} \left(\mathbf{X}, \lambda, x_0 \right) = \frac{1}{\sum_{i=1}^n w_i} \sum_{i=1}^n w_i \frac{\left( F_{\epsilon}\left(x_i \right) - F_{\mathcal{N}} \left(\phi^{\lambda, x_0, s} \left(x_i \right); \mu, \sigma \right) \right)^2} {F_{\mathcal{N}} \left(\phi^{\lambda, x_0, s} \left(x_i \right); \mu, \sigma \right) \left(1 - F_{\mathcal{N}} \left(\phi^{\lambda, x_0, s} \left(x_i \right); \mu, \sigma \right) \right) }
\end{equation}

Here \(w_i\) are weights, and \(\mu\) and \(\sigma\) are location and
scale parameters. For non-robust power transformations, all \(w_i = 1\).
Note that this criterion is not the same as the Anderson-Darling test
statistic (Anderson and Darling 1952), which involves solving (or
approximating) an integral function, contains an extra scalar
multiplication term, and does not include weights. The Anderson-Darling
criterion seeks to minimise the squared Euclidean distance between the
EDF and the normal CDF, with differences at the upper and lower end of
the normal CDF receiving more weight than those at the the centre of the
CDF.

\subsubsection{Cramér-von Mises
criterion}\label{cramuxe9r-von-mises-criterion}

The Cramér-von Mises criterion is also based on the empirical
distribution function of \(\mathbf{X}\). We define the Cramér-von Mises
criterion as follows:

\begin{equation}
U_{\text{CvM}} \left(\mathbf{X}, \lambda, x_0 \right) = \frac{1}{\sum_{i=1}^n w_i} \sum_{i=1}^n w_i \left( F_{\epsilon}\left(x_i \right) - F_{\mathcal{N}} \left(\phi^{\lambda, x_0, s} \left(x_i \right); \mu, \sigma \right) \right)^2
\end{equation}

Here \(w_i\) are weights, and \(\mu\) and \(\sigma\) are location and
scale parameters. For non-robust power transformations, all \(w_i = 1\).
The criterion is similar to the Cramér-von Mises test statistic Mises
(1928), aside from a additive scalar value and the introduction of
weights. This criterion, like the Anderson-Darling criterion, seeks to
minimise the squared Euclidean distance between the EDF and the normal
CDF. Unlike the Anderson-Darling criterion, this criterion weights all
instances equally.

For conventional power transformations with a fixed shift parameter, the
transformation \(\phi^{\lambda, x_0, s} (\mathbf{X})\) may be
substituted by \(\phi^{\lambda} (\mathbf{X})\) in the definition of the
Cramér-von Mises criterion.

\subsection{Skewness-kurtosis-based
criteria}\label{skewness-kurtosis-based-criteria}

The second class of criteria seeks to reduce skewness and (excess)
kurtosis of the transformed feature \(\mathbf{Y}\). We will first define
the location \(\mu\) and scale \(\sigma\) of the the transformed as
these are required for computing skewness and kurtosis. Here, \(\mu\) is
defined as:

\begin{equation}
\mu = \frac{\sum_{i=1}^n \phi^{\lambda, x_0, s} \left(x_i \right)} {\sum_{i=1}^n w_i}
\end{equation}

The location, or mean, is weighted using weights \(w_i\). For non-robust
transformations, \(w_i = 1\). Then, \(\sigma^2\) is defined as:

\begin{equation}
\sigma^2 = \frac{\sum_{i=1}^n w_i \left(\phi^{\lambda, x_0, s} \left( x_i \right) - \mu \right)^2}{\sum_{i=1}^n w_i}
\end{equation}

Skewness is defined as:

\begin{equation}
s = \frac{\sum_{i=1}^n w_i \left(\phi^{\lambda, x_0, s} \left( x_i \right) - \mu \right)^3}{\sigma^3 \sum_{i=1}^n w_i}
\end{equation}

Kurtosis is defined as:

\begin{equation}
k = \frac{\sum_{i=1}^n w_i \left(\phi^{\lambda, x_0, s} \left( x_i \right) - \mu \right)^4}{\sigma^4 \sum_{i=1}^n w_i}
\end{equation}

\subsubsection{D'Agostino criterion}\label{dagostino-criterion}

The D'Agostino criterion defined here follows the D'Agostino \(K^2\)
test statistic (D'Agostino and Belanger 1990). This test statistic is
composed of two separate test statistics, one of which is related to
skewness, and the other to kurtosis. Both test statistics are computed
in several steps. Let us first define \(\nu=\sum_{i=1}^n w_i\). Thus for
non-robust power transformations, \(\nu = n\).

For the skewness test statistic we first compute (D'Agostino and
Belanger 1990):

\begin{equation}
\beta_1 = s \sqrt{ \frac{\left(\nu + 1\right) \left(\nu + 3\right)} {6 \left(\nu - 2\right)} }
\end{equation}

\begin{equation}
\beta_2 = 3 \frac{\left(\nu^2 + 27\nu - 70\right) \left(\nu + 1\right) \left(\nu + 3\right)} {\left(\nu - 2\right) \left(\nu + 5\right) \left(\nu + 7\right) \left(\nu + 9\right)}
\end{equation}

\begin{equation}
\alpha = \sqrt{\frac{2} {\sqrt{2 \beta_2 - 2} - 2}}
\end{equation}

\begin{equation}
\delta = \frac{1}{\sqrt{\log \left[\sqrt{-1 + \sqrt{2 * \beta_2 - 2}} \right]}}
\end{equation}

The skewness test statistic is then:

\begin{equation}
Z_s = \delta \log\left[\frac{\beta_1}{\alpha} + \sqrt{\frac{\beta_1^2}{\alpha^2} + 1} \right]
\end{equation}

For the kurtosis test statistic we first compute (D'Agostino and
Belanger 1990; Anscombe and Glynn 1983):

\begin{equation}
\beta_1 = 3 \frac{\nu - 1}{\nu + 1}
\end{equation}

\begin{equation}
\beta_2 = 24 \nu \frac{\left(\nu - 2\right)\left(\nu - 3\right)}{\left(\nu + 1\right)^2 \left(\nu + 3\right) \left(\nu + 5\right)}
\end{equation}

\begin{equation}
\beta_3 = 6 \frac{\nu^2 - 5 \nu + 2}{\left(\nu + 7\right) \left(\nu + 9\right)} \sqrt{6 \frac{\left(\nu + 3\right) \left(\nu + 5\right)}{\nu \left(\nu - 2\right) \left(\nu - 3 \right)}}
\end{equation}

\begin{equation}
\alpha_1 = 6 + \frac{8}{\beta_3} \left[\frac{2}{\beta_3} + \sqrt{1 + \frac{4}{\beta_3^2}} \right]
\end{equation}

\begin{equation}
\alpha_2 = \frac{k - \beta_1}{\sqrt{\beta_2}}
\end{equation}

The kurtosis test statistic is then:

\begin{equation}
Z_k = \sqrt{\frac{9 \alpha_1}{2}} \left[ 1 - \frac{2}{9 \alpha_1} - \left(\frac{1 - 2 / \alpha_1}{1 + \alpha_2 \sqrt{2 / \left(\alpha_1 - 4 \right)}} \right)^{1 / 3}  \right]
\end{equation}

The D'Agostino \(K^2\) test statistic and our criterion are the same,
and are defined as:

\begin{equation}
U_{\text{DA}} \left(\mathbf{X}, \lambda, x_0 \right) = Z_s^2 + Z_k^2
\end{equation}

The main difference between the test statistic as originally formulated,
and the criterion proposed here is the presence of weights for robust
power transformation.

\subsubsection{Jarque-Bera criterion}\label{jarque-bera-criterion}

The second criterion based on skewness and kurtosis is the Jarque-Bera
criterion. It is relatively simple to compute compared to the D'Agostino
criterion:

\begin{equation}
U_{\text{JB}} \left(\mathbf{X}, \lambda, x_0 \right) = s^2 + \left(k - 3\right)^2 / 4
\end{equation}

The main difference between the above criterion and the Jarque-Bera test
statistic (Jarque and Bera 1980) is that a scalar multiplication is
absent.

\subsection{Optimisation using non-MLE
criteria}\label{optimisation-using-non-mle-criteria}

Each of the above criteria can be used for optimisation, i.e.:

\begin{equation}
\left\{ \hat{\lambda}, \hat{x}_0, \hat{s}_0 \right\} = \argmin_{\lambda, x_0, s} U\left(\mathbf{X}, \lambda, x_0, s \right)
\end{equation}

For conventional power transformations with fixed location and scale
parameters, the transformation \(\phi^{\lambda, x_0, s} (\mathbf{X})\)
may be substituted by \(\phi^{\lambda} (\mathbf{X})\), or equivalently,
\(x_0\) and \(s\) may be fixed:

\begin{equation}
\left\{ \hat{\lambda}\right\} = \argmin_{\lambda} U\left(\mathbf{X}, \lambda; x_0, s \right)
\end{equation}

\section{Appendix C: Simulations with other optimisation
criteria}\label{appendix-c-simulations-with-other-optimisation-criteria}

Invariance of location- and scale-invariant power transformations was
assessed using the optimisation criteria in
\href{Appendix\%20B:\%20Optimisation\%20of\%20transformation\%20parameters}{Appendix
B}. This follows the simulation in the main manuscript, where MLE was
used for optimization. In short, we first randomly drew \(10000\) values
from a normal distribution:
\(\mathbf{X}_{\text{normal}} = \left\{x_1, x_2, \ldots, x_{10000} \right\} \sim \mathcal{N}\left(0, 1\right)\),
or equivalently
\(\mathbf{X}_{\text{normal}} = \left\{x_1, x_2, \ldots, x_{10000} \right\} \sim \mathcal{AGN}\left(0, 1/\sqrt{2}, 0.5, 2\right)\).
The second distribution was a right-skewed normal distribution
\(\mathbf{X}_{\text{right}} = \left\{x_1, x_2, \ldots, x_{10000} \right\} \sim \mathcal{AGN}\left(0, 1/\sqrt{2}, 0.2, 2\right)\).
The third distribution was a left-skewed normal distribution
\(\mathbf{X}_{\text{left}} = \left\{x_1, x_2, \ldots, x_{10000} \right\} \sim \mathcal{AGN}\left(0, 1/\sqrt{2}, 0.8, 2\right)\).
We then computed transformation parameter \(\lambda\) using the original
definitions (equations \ref{eqn:box-cox-original} and
\ref{eqn:yeo-johnson-original}) and the location- and scale-invariant
definitions (equations \ref{eqn:box-cox-invariant} and
\ref{eqn:yeo-johnson-invariant}) for each distribution using different
optimisation criteria. To assess location invariance, a positive value
\(d_{\text{shift}}\) was added to each distribution with
\(d_{\text{shift}} \in [1, 10^6]\). Similarly, to assess scale
invariance, each distribution was multiplied by a positive value
\(d_{\text{scale}}\), where \(d_{\text{scale}} \in [1, 10^6]\).

The results are shown in Figure
\ref{fig:shifted-distributions-appendix}.

\begin{figure}

{\centering \includegraphics{manuscript_appendix_files/figure-latex/shifted-distributions-appendix-1} 

}

\caption{Invariant power transformation produces transformation parameters that are invariant to location and scale. Samples were drawn from normal, right-skewed and left-skewed distributions, respectively, which then underwent a shift $d_{\text{shift}}$ or multiplication by $d_{\text{scale}}$. Estimates of the transformation parameter $\lambda$ for the conventional power transformations show strong dependency on the overall location and scale of the distribution and the optimisation criterion, whereas estimates obtained for the location- and scale-invariant power transformations are constant. For location- and scale-invariant power transformations, the Anderson-Darling criterion leads to unstable estimates of $\lambda$ for skewed distributions, possibly due to large weights being assigned to samples at the upper and lower ends of the distribution.}\label{fig:shifted-distributions-appendix}
\end{figure}

\section{Appendix D: Simulations on clean
data}\label{appendix-d-simulations-on-clean-data}

An alternative to location- and scale-invariant transformations is
normalising feature distributions prior to conventional transformations.
We assessed two normalisation methods were used: 1. z-standardisation,
i.e.~\(x^{\prime}_{i} = \left(x_i - \mu \right) / \sigma\), with \(\mu\)
and \(\sigma\) the mean and standard deviation of feature
\(\mathbf{X}\); and 2. robust scaling,
i.e.~\(x^{\prime}_{i} = \left(x_i - \text{median}\left(\mathbf{X}\right) \right) / \text{IQR}\left(\mathbf{X}\right)\),
with \(\text{IQR}\) representing the interquartile range of feature
\(\mathbf{X}\).

{[}Generated data: clean, n = 30, n = 100, n = 1000, lambda = 0.1, 1.0,
1.9{]}

\begin{table}
\begin{center}
\caption{Residual errors for features from simulated clean data without outliers after Yeo-Johnson transformation to normality.
Several transformation methods include normalisation before transformation, indicated by z-score normalisation (norm.) or robust scaling.}
\label{tab:clean-transformation-residuals-appendix}
\small{
\begin{tabular}{l | l r r r r r r r r r}

\toprule
& n: & \multicolumn{3}{c}{30} & \multicolumn{3}{c}{100} & \multicolumn{3}{c}{500} \\
transformation & $\lambda$: & 0.1 & 1.0 & 1.9 & 0.1 & 1.0 & 1.9 & 0.1 & 1.0 & 1.9 \\

\midrule

none                                  & & 4.0 & 3.4 & 4.6 & 40.1 & 8.9 & 20.8 & 184.6 & 10.1 & 191.8 \\
conventional                          & & 2.7 & 3.3 & 3.6 &  6.5 & 8.1 &  5.6 &  14.2 & 10.1 &  16.1 \\
conventional (z-score norm.)          & & 2.5 & 3.3 & 3.7 &  9.8 & 8.1 &  5.6 &  24.1 & 10.1 &  15.9 \\
conventional (robust scaling)         & & 2.6 & 3.3 & 3.7 &  7.4 & 8.2 &  5.6 &  15.5 & 10.1 &  14.0 \\
Raymaekers-Rousseeuw                  & & 3.8 & 3.3 & 3.6 &  6.5 & 8.5 &  5.6 &  14.4 & 11.0 &  17.6 \\
Raymaekers-Rousseeuw (z-score norm.)  & & 2.6 & 3.3 & 3.7 &  9.8 & 8.5 &  5.6 &  24.1 & 11.1 &  15.9 \\
Raymaekers-Rousseeuw (robust scaling) & & 2.6 & 3.3 & 3.7 &  7.4 & 8.6 &  5.6 &  15.4 & 11.1 &  15.1 \\
invariant                             & & 3.0 & 3.5 & 3.6 &  5.0 & 8.1 &  5.6 &  13.1 & 10.9 &  17.8 \\
robust invariant                      & & 3.0 & 3.3 & 3.6 &  5.2 & 8.3 &  5.9 &  19.9 & 13.6 &  32.9 \\
\bottomrule
\end{tabular}
}
\end{center}
\end{table}

\begin{table}
\begin{center}
\caption{Transformation parameter $\lambda$ for features from simulated clean data without outliers after Yeo-Johnson transformation to normality.
Several transformation methods include normalisation before transformation, indicated by z-score normalisation (norm.) or robust scaling.}
\label{tab:clean-transformation-lambda-appendix}
\small{
\begin{tabular}{l | l r r r r r r r r r}

\toprule
& n: & \multicolumn{3}{c}{30} & \multicolumn{3}{c}{100} & \multicolumn{3}{c}{500} \\
transformation & $\lambda$: & 0.1 & 1.0 & 1.9 & 0.1 & 1.0 & 1.9 & 0.1 & 1.0 & 1.9 \\

\midrule

conventional                          & & 0.6 & 1.2 & 1.5 &  0.0 & 0.9 & 1.6 &  0.1 & 1.0 & 1.9 \\
conventional (z-score norm.)          & & 0.5 & 1.2 & 1.5 & -0.2 & 0.9 & 1.7 & -0.2 & 1.0 & 2.2 \\
conventional (robust scaling)         & & 0.5 & 1.3 & 1.6 & -0.3 & 0.9 & 1.7 & -0.2 & 1.0 & 2.1 \\
Raymaekers-Rousseeuw                  & & 1.0 & 1.2 & 1.5 &  0.0 & 0.7 & 1.6 &  0.1 & 1.0 & 1.9 \\
Raymaekers-Rousseeuw (z-score norm.)  & & 0.7 & 1.2 & 1.5 & -0.2 & 0.7 & 1.7 & -0.2 & 1.0 & 2.2 \\
Raymaekers-Rousseeuw (robust scaling) & & 0.6 & 1.3 & 1.6 & -0.3 & 0.6 & 1.7 & -0.2 & 1.0 & 2.1 \\
invariant                             & & 0.4 & 1.4 & 1.7 &  0.1 & 0.9 & 1.8 &  0.1 & 1.1 & 3.0 \\
robust invariant                      & & 0.4 & 1.3 & 1.5 &  0.0 & 0.8 & 1.7 &  0.0 & 1.1 & 2.0 \\
\bottomrule
\end{tabular}
}
\end{center}
\end{table}

\begin{table}
\begin{center}
\caption{
p-values of empirical central normality tests for features from simulated clean data without outliers after Yeo-Johnson transformation to normality.
Several transformation methods include normalisation before transformation, indicated by z-score normalisation (norm.) or robust scaling.}
\label{tab:clean-transformation-p-value-appendix}
\small{
\begin{tabular}{p{3.5cm} | l r r r r r r r r r}

\toprule
& n: & \multicolumn{3}{c}{30} & \multicolumn{3}{c}{100} & \multicolumn{3}{c}{500} \\
transformation & $\lambda$: & 0.1 & 1.0 & 1.9 & 0.1 & 1.0 & 1.9 & 0.1 & 1.0 & 1.9 \\

\midrule

none                                  & & 0.986 & 0.614 & 0.323 & $<0.001$ & 0.063 & 0.016 & $<0.001$ & 0.997 & $<0.001$ \\
conventional                          & & 0.986 & 0.464 & 0.488 &   0.675  & 0.139 & 0.620 &   0.902  & 0.999 &   0.698 \\
conventional (z-score norm.)          & & 0.979 & 0.440 & 0.477 &   0.200  & 0.141 & 0.770 &   0.419  & 0.999 &   0.723 \\
conventional (robust scaling)         & & 0.982 & 0.439 & 0.484 &   0.487  & 0.130 & 0.683 &   0.883  & 0.999 &   0.817 \\
Raymaekers-Rousseeuw                  & & 0.989 & 0.464 & 0.488 &   0.675  & 0.446 & 0.620 &   0.876  & 0.992 &   0.821 \\
Raymaekers-Rousseeuw (z-score norm.)  & & 0.992 & 0.440 & 0.477 &   0.200  & 0.448 & 0.770 &   0.460  & 0.991 &   0.719 \\
Raymaekers-Rousseeuw (robust scaling) & & 0.993 & 0.439 & 0.484 &   0.487  & 0.422 & 0.683 &   0.887  & 0.991 &   0.848 \\
invariant                             & & 0.993 & 0.355 & 0.461 &   0.720  & 0.153 & 0.490 &   0.910  & 0.999 &   0.682 \\
robust invariant                      & & 0.994 & 0.407 & 0.484 &   0.642  & 0.291 & 0.489 &   0.848  & 0.996 &   0.628 \\
\bottomrule
\end{tabular}
}
\end{center}
\end{table}

\section{Appendix D: Experimental results using location- and
scale-invariant Box-Cox
transformation}\label{appendix-d-experimental-results-using-location--and-scale-invariant-box-cox-transformation}

The effect of using location- and scale-invariant transformations was
investigated using real-world datasets.

\subsection{Invariance}\label{invariance}

Results for Box-Cox transformations of features without outliers are
shown in Figure \ref{fig:experimental-results-invariance-appendix}.

\begin{figure}

{\centering \includegraphics{manuscript_appendix_files/figure-latex/experimental-results-invariance-appendix-1} 

}

\caption{Quantile-quantile plots for several datasets: age of patients with lung cancer (top row); penguin body mass (middle row); and latitude coordinates of houses sold in Ames, Iowa (bottom row). Multiple quantile-quantile plots are shown: for the original feature (left column); the feature transformed using the conventional Box-Cox transformation and Raymaekers and Rousseeuw's robust adaptation (middle column); and the feature transformed using the non-robust and robust location- and-scale invariant Box-Cox transformations (right column).}\label{fig:experimental-results-invariance-appendix}
\end{figure}

\subsubsection{Age of patients with lung
cancer}\label{age-of-patients-with-lung-cancer}

Applying conventional and invariant Box-Cox transformations to age of
patients with lung cancer (Loprinzi et al. 1994) yielded the following
results: no transformation (sum of residuals with normal distribution
\(\sum r_i = 16.5\), \(p = 0.71\)); conventional transformation
(\(\lambda = 1.9\), \(\sum r_i = 11.5\), \(\mu_{BC} = 1.6 \cdot 10^3\),
\(\sigma_{BC} = 0.4 \cdot 10^3\), \(p = 0.94\)); Raymaekers and
Rousseeuw's robust adaptation (\(\lambda = 1.9\), \(\sum r_i = 11.5\),
\(\mu_{BC} = 1.6 \cdot 10^3\), \(\sigma_{BC} = 0.4 \cdot 10^3\),
\(p = 0.94\)); location- and scale-invariant transformation
(\(\lambda = 1.7\), \(\sum r_i = 11.6\), \(\mu_{BC} = 1.9\),
\(\sigma_{BC} = 0.8\), \(p = 0.94\)); and robust location- and
scale-invariant transformation (\(\lambda = 1.5\), \(\sum r_i = 11.6\),
\(\mu_{BC} = 3.6\), \(\sigma_{BC} = 1.2\), \(p = 0.93\)).

Compared to location- and scale-invariant Yeo-Johnson transformations,
the Box-Cox transformations do not reduce residuals compared to
conventional variants.

\subsubsection{Penguin body mass}\label{penguin-body-mass}

Applying conventional and invariant Box-Cox transformations to the body
mass of penguins (Gorman, Williams, and Fraser 2014) yielded the
following results: no transformation (residual sum \(\sum r_i = 48.0\),
\(p < 0.001\)); conventional transformation (\(\lambda = -0.5\),
\(\sum r_i = 32.2\), \(\mu_{BC} = 2.1\),
\(\sigma_{BC} = 4 \cdot 10^{-3}\), \(p = 0.06\)); Raymaekers and
Rousseeuw's robust adaptation (\(\lambda = -0.5\), \(\sum r_i = 32.2\),
\(\mu_{BC} = 2.1\), \(\sigma_{BC} = 4 \cdot 10^{-3}\), \(p = 0.06\));
location- and scale-invariant transformation (\(\lambda = 0.5\),
\(\sum r_i = 27.3\), \(\mu_{BC} = 0.3\), \(\sigma_{BC} = 0.6\),
\(p = 0.10\)); and robust location- and scale-invariant transformation
(\(\lambda = 0.2\), \(\sum r_i = 25.2\), \(\mu_{BC} = 0.4\),
\(\sigma_{BC} = 0.6\), \(p = 0.44\)).

Just as for location- and scale-invariant Yeo-Johnson transformations,
Box-Cox transformations produced a lower overall residual sum compared
to their conventional counterparts. Similarly, conventional
transformations led to low standard deviation \(\sigma_{YJ}\) of the
body mass feature after transformation.

\subsubsection{Latitude in the Ames housing
dataset}\label{latitude-in-the-ames-housing-dataset}

Applying conventional and invariant Box-Cox transformations to the
latitude of houses in the Ames housing dataset (De Cock 2011) yielded
the following results: no transformation (residual sum
\(\sum r_i = 328\), \(p < 0.001\)); conventional transformation
(\(\lambda = 62.1\), \(\sum r_i = 319\),
\(\mu_{BC} = 1.1 \cdot 10^{99}\), \(\sigma_{BC} = 0.0 \cdot 10^{99}\),
\(p < 0.001\)); Raymaekers and Rousseeuw's robust adaptation
(\(\lambda = 96.0\), \(\sum r_i = 319\),
\(\mu_{BC} = 6.2 \cdot 10^{153}\), \(\sigma_{BC} = 0.3 \cdot 10^{153}\),
\(p < 0.001\)); location- and scale-invariant transformation
(\(\lambda = 1.9\), \(\sum r_i = 312\), \(\mu_{BC} = 2.3\),
\(\sigma_{BC} = 0.9\), \(p < 0.001\)); and robust location- and
scale-invariant transformation (\(\lambda = 1.2\), \(\sum r_i = 316\),
\(\mu_{BC} = 5.5\), \(\sigma_{BC} = 1.4\), \(p < 0.001\)).

Similar to conventional Yeo-Johnson transformations (non-robust and
robust), conventional Box-Cox transformations had high values for the
\(\lambda\) parameter, which could lead to numerical issues. Location-
and scale-invariant Box-Cox transformations did not suffer from this
issue.

\subsection{Robustness against
outliers}\label{robustness-against-outliers}

Results for Box-Cox transformations of features with outliers are shown
in Figure \ref{fig:experimental-results-outlier-robustness-appendix}.

\begin{figure}

{\centering \includegraphics{manuscript_appendix_files/figure-latex/experimental-results-outlier-robustness-appendix-1} 

}

\caption{Quantile-quantile plots for two datasets with outliers: vehicle fuel consumption (top row), where outliers are related to highly fuel-efficient vehicles; and maximum arterial wall thickness in patients with ischemic stroke (bottom row). Multiple quantile-quantile plots are shown: for the original feature (left column); the feature transformed using the conventional Box-Cox transformation and Raymaekers and Rousseeuw's robust adaptation (middle column); and the feature transformed using the non-robust and robust location- and-scale invariant Box-Cox transformations (right column). Samples with observed quantiles below $-3.0$ or above $3.0$ are indicated by crosses.}\label{fig:experimental-results-outlier-robustness-appendix}
\end{figure}

\subsubsection{Fuel efficiency in the Top Gear
dataset}\label{fuel-efficiency-in-the-top-gear-dataset}

The Top Gear dataset contains data on 297 vehicles, with outliers
related highly fuel-efficient vehicles (Alfons 2021). Applying
conventional and invariant Box-Cox transformations to the fuel
consumption feature yielded the following results: no transformation
(residual sum \(\sum r_i = 54\), \(p=0.58\)); conventional
transformation (\(\lambda = -0.1\), \(\sum r_i = 55\),
\(\mu_{BC} = 3.0\), \(\sigma_{BC} = 0.3\), \(p < 0.001\)); Raymaekers
and Rousseeuw's robust adaptation (\(\lambda = 0.8\), \(\sum r_i = 48\),
\(\mu_{BC} = 29\), \(\sigma_{BC} = 15\), \(p=0.32\)); location- and
scale-invariant transformation (\(\lambda = -0.7\), \(\sum r_i = 44\),
\(\mu_{BC} = 0.6\), \(\sigma_{BC} = 0.2\), \(p < 0.001\)); and robust
location- and scale-invariant transformation (\(\lambda = 1.1\),
\(\sum r_i = 59\), \(\mu_{BC} = 2.4\), \(\sigma_{BC} = 1.8\),
\(p=0.67\)).

\subsubsection{Maximum arterial wall thickness in an ischemic stroke
dataset}\label{maximum-arterial-wall-thickness-in-an-ischemic-stroke-dataset}

The ischemic stroke dataset contains historic data from 126 patients
with risk at ischemic stroke (Kuhn and Johnson 2019). Applying
conventional and invariant Box-Cox transformations to the maximum
arterial wall thickness feature yielded the following results: no
transformation (residual sum \(\sum r_i = 110\), \(p=0.86\));
conventional transformation (\(\lambda = -0.5\), \(\sum r_i = 33\),
\(\mu_{BC} = 1.0\), \(\sigma_{BC} = 0.2\), \(p=0.01\)); Raymaekers and
Rousseeuw's robust adaptation (\(\lambda = 1.1\), \(\sum r_i = 127\),
\(\mu_{BC} = 5.5\), \(\sigma_{BC} = 12\), \(p=0.90\)); location- and
scale-invariant transformation (\(\lambda = -1.0\), \(\sum r_i = 28\),
\(\mu_{BC} = 0.7\), \(\sigma_{BC} = 0.1\), \(p=0.02\)); and robust
location- and scale-invariant transformation (\(\lambda = 0.5\),
\(\sum r_i = 56\), \(\mu_{BC} = 2.2\), \(\sigma_{BC} = 1.4\),
\(p=0.60\)).

\section{Appendix E: Empirical central normality
test}\label{appendix-e-empirical-central-normality-test}

Critical values for the central normality test and its empirical variant
are found in Table \ref{tab:central-normality-critical-statistic} and
Table \ref{tab:empirical-central-normality-critical-statistic},
respectively.

\begin{table}
\begin{center}
\caption{Critical values of test statistic $\tau_{\alpha, n, \kappa = 0.70}$ for
\textbf{central normality} at $\kappa = 0.70$, as a function of significance 
level $\alpha$ and number of instances $n$. The values shown must be divided by $100$.}
\label{tab:central-normality-critical-statistic}
\begin{tabular}{l | r r r r r r r r r}

\toprule
$n$ \textbackslash $\alpha$ & 0.9 & 0.8 & 0.5 & 0.2 & 0.1 & 0.05 & 0.025 & 0.01 & 0.001 \\

\midrule
5     & 10.49 & 13.15 & 17.46 & 22.17 & 25.28 & 27.90 & 29.93 & 31.88 & 34.58 \\
10    &  8.67 & 10.14 & 13.66 & 18.16 & 21.11 & 23.91 & 26.96 & 31.44 & 48.04 \\
20    &  6.77 &  7.71 &  9.97 & 12.96 & 14.93 & 16.70 & 18.24 & 20.33 & 25.24 \\
50    &  4.63 &  5.20 &  6.59 &  8.49 &  9.69 & 10.81 & 11.87 & 13.14 & 16.11 \\
100   &  3.32 &  3.73 &  4.71 &  6.06 &  6.92 &  7.71 &  8.45 &  9.39 & 11.31 \\
200   &  2.37 &  2.66 &  3.35 &  4.29 &  4.89 &  5.46 &  6.00 &  6.67 &  8.02 \\
500   &  1.51 &  1.69 &  2.12 &  2.73 &  3.12 &  3.48 &  3.84 &  4.24 &  5.30 \\
1000  &  1.07 &  1.20 &  1.50 &  1.92 &  2.19 &  2.44 &  2.68 &  3.01 &  3.68 \\
2000  &  0.76 &  0.85 &  1.06 &  1.37 &  1.56 &  1.74 &  1.90 &  2.11 &  2.55 \\
5000  &  0.48 &  0.54 &  0.67 &  0.86 &  0.99 &  1.10 &  1.20 &  1.34 &  1.64 \\
10000 &  0.34 &  0.38 &  0.48 &  0.61 &  0.69 &  0.77 &  0.84 &  0.93 &  1.15 \\
\bottomrule
\end{tabular}
\end{center}
\end{table}

\begin{table}
\begin{center}
\caption{Critical values of test statistic $\tau_{\alpha, n, \kappa = 0.70}$ for
\textbf{empirical central normality} at $\kappa = 0.70$, as a function of significance 
level $\alpha$ and number of instances $n$. The values shown must be divided by $100$.}
\label{tab:empirical-central-normality-critical-statistic}
\begin{tabular}{l | r r r r r r r r r}

\toprule
$n$ \textbackslash $\alpha$ & 0.9 & 0.8 & 0.5 & 0.2 & 0.1 & 0.05 & 0.025 & 0.01 & 0.001 \\

\midrule
5     & 12.04 & 14.02 & 17.37 & 21.26 & 24.02 & 26.45 & 28.46 & 30.65 & 33.90 \\
10    &  8.75 & 10.23 & 13.82 & 18.53 & 21.58 & 24.31 & 27.01 & 30.82 & 41.82 \\
20    &  6.80 &  7.74 & 10.03 & 13.17 & 15.12 & 16.95 & 18.64 & 20.79 & 25.07 \\
50    &  4.67 &  5.26 &  6.69 &  8.70 &  9.99 & 11.18 & 12.32 & 13.65 & 16.73 \\
100   &  3.38 &  3.79 &  4.83 &  6.21 &  7.13 &  7.97 &  8.72 &  9.72 & 11.78 \\ 
200   &  2.47 &  2.77 &  3.51 &  4.54 &  5.19 &  5.77 &  6.31 &  6.92 &  8.47 \\
500   &  1.65 &  1.86 &  2.38 &  3.06 &  3.47 &  3.85 &  4.19 &  4.62 &  5.58 \\
1000  &  1.27 &  1.44 &  1.84 &  2.35 &  2.65 &  2.90 &  3.15 &  3.43 &  4.08 \\
2000  &  1.06 &  1.20 &  1.53 &  1.91 &  2.13 &  2.32 &  2.48 &  2.68 &  3.08 \\
5000  &  0.95 &  1.07 &  1.30 &  1.56 &  1.69 &  1.81 &  1.91 &  2.04 &  2.30 \\
10000 &  0.96 &  1.05 &  1.23 &  1.41 &  1.50 &  1.58 &  1.65 &  1.75 &  1.92 \\
\bottomrule
\end{tabular}
\end{center}
\end{table}

\begin{figure}

{\centering \includegraphics{manuscript_appendix_files/figure-latex/empirical-central-normality-critical-statistics-1} 

}

\caption{Critical test statistic $\tau_{\alpha, n, \kappa = 0.70}$ of the (empirical) central normality test as function of $n$ for several values of significance level $\alpha$. The critical test statistics for central normality test are determined using fully normal data, whereas the statistics for the empirical variant are determined using centrally normal data, i.e. with fully normal data where 10\% of elements are replaced by outliers. emp: empirical}\label{fig:empirical-central-normality-critical-statistics}
\end{figure}

\section{Appendix F: Normalisation before
transformation}\label{appendix-f-normalisation-before-transformation}

An alternative to location- and scale-invariant transformations is
normalising feature distributions prior to conventional transformations.
We assessed two normalisation methods were used: 1. z-standardisation,
i.e.~\(x^{\prime}_{i} = \left(x_i - \mu \right) / \sigma\), with \(\mu\)
and \(\sigma\) the mean and standard deviation of feature
\(\mathbf{X}\); and 2. robust scaling,
i.e.~\(x^{\prime}_{i} = \left(x_i - \text{median}\left(\mathbf{X}\right) \right) / \text{IQR}\left(\mathbf{X}\right)\),
with \(\text{IQR}\) representing the interquartile range of feature
\(\mathbf{X}\).

Table \ref{tab:normalisation-before-transformation-appendix} shows
residual errors after transformation to normality of the five features
from real-world datasets presented previously in Appendix D and the main
manuscript. Table
\ref{tab:normalisation-before-transformation-lambda-appendix} shows the
corresponding values for transformation parameter \(\lambda\),
\ref{tab:normalisation-before-transformation-p-value-appendix} shows
p-values of the empirical central normality test. Normalisation prior to
transformation prevents unexpectedly high \(\lambda\) values in the
presence of large location shifts, as can be observed for the latitude
feature. Normalisation prior to transformation, however, does not
consistently improve residual errors after transformation.
Interestingly, use of normalisation prior to transformation with robust
power transformation using the method by Raymaekers and Rousseeuw
(Raymaekers and Rousseeuw 2024) led to higher residual errors for
arterial wall thickness, fuel efficiency and latitude features. This is
similar to observations by Raymaekers and Rousseeuw (2024), who observed
that their method can emphasize values of outliers after transformation.
Location- and scale-invariant transformations have similar or lower
residual errors compared to errors resulting from normalisation prior to
transformation. Not surprisingly, normalisation before transformation
does not noticeably improve central normality, as assessed using the
empirical central normality test.

\begin{table}
\begin{center}
\caption{Residual errors for features from real-world datasets after Yeo-Johnson transformation to normality. 
Several transformation methods include normalisation before transformation, indicated by z-score normalisation (norm.) or robust scaling. 
AWT: arterial wall thickness; FE: fuel efficiency; PBM: penguin body mass}
\label{tab:normalisation-before-transformation-appendix}
\begin{tabular}{l | r r r r r}

\toprule
feature & age & AWT & FE & latitude & PBM \\

\midrule
none & 16.5 & 110.1 & 54.5 & 328.4 & 48.0 \\
conventional & 11.5 & 30.0 & 55.3 & 319.0 & 32.2 \\
conventional (z-score norm.) & 11.5 & 19.3 & 49.0 & 326.2 & 33.3 \\
conventional (robust scaling) & 11.3 & 31.8 & 53.3 & 324.5 & 32.2 \\
Raymaekers-Rousseeuw & 11.5 & 136.7 & 47.7 & 315.1 & 32.2 \\
Raymaekers-Rousseeuw (z-score norm.) & 13.2 & 214.5 & 57.4 & 326.2 & 33.3 \\
Raymaekers-Rousseeuw (robust scaling) & 11.7 & 281.3 & 57.0 & 324.5 & 32.0 \\
invariant & 8.8 & 12.2 & 44.0 & 326.4 & 26.8 \\
robust invariant & 10.6 & 27.1 & 49.5 & 310.6 & 23.1 \\
\bottomrule
\end{tabular}
\end{center}
\end{table}

\begin{table}
\begin{center}
\caption{Transformation parameter $\lambda$ for features from real-world datasets after Yeo-Johnson transformation to normality. 
Several transformation methods include normalisation before transformation, indicated by z-score normalisation (norm.) or robust scaling. 
AWT: arterial wall thickness; FE: fuel efficiency; PBM: penguin body mass}
\label{tab:normalisation-before-transformation-lambda-appendix}
\begin{tabular}{l | r r r r r}

\toprule
feature & age & AWT & FE & latitude & PBM \\

\midrule
conventional & 2.0 & -0.7 & -0.1 & 62.1 & -0.5 \\
conventional (z-score norm.) & 1.2 & -1.7 & -0.1 & 1.3 & 0.6 \\
conventional (robust scaling) & 1.3 & 0.0 & 0.2 & 1.4 & 0.4 \\
Raymaekers-Rousseeuw & 2.0 & 1.1 & 0.8 & 95.4 & -0.5 \\
Raymaekers-Rousseeuw (z-score norm.) & 1.3 & 1.4 & 1.0 & 1.3 & 0.6 \\
Raymaekers-Rousseeuw (robust scaling) & 1.4 & 1.3 & 1.0 & 1.4 & 0.4 \\
invariant & 1.3 & 0.2 & -1.3 & 1.5 & 0.5 \\
robust invariant & 1.4 & -0.6 & 0.9 & 1.4 & 0.4 \\
\bottomrule
\end{tabular}
\end{center}
\end{table}

\begin{table}
\begin{center}
\caption{
p-values of empirical central normality tests for features from real-world datasets after Yeo-Johnson transformation to normality.
Several transformation methods include normalisation before transformation, indicated by z-score normalisation (norm.) or robust scaling. 
AWT: arterial wall thickness; FE: fuel efficiency; PBM: penguin body mass}
\label{tab:normalisation-before-transformation-p-value-appendix}
\begin{tabular}{l | r r r r r}

\toprule
feature & age & AWT & FE & latitude & PBM \\

\midrule
none                                  & 0.712 & 0.864 & 0.577     & $< 0.001$ & $< 0.001$ \\
conventional                          & 0.936 & 0.017 & $< 0.001$ & $< 0.001$ & 0.058 \\
conventional (z-score norm.)          & 0.860 & 0.058 & $< 0.001$ & $< 0.001$ & 0.054 \\
conventional (robust scaling)         & 0.881 & 0.001 & $< 0.001$ & $< 0.001$ & 0.076 \\
Raymaekers-Rousseeuw                  & 0.936 & 0.905 & 0.320     & $< 0.001$ & 0.058 \\
Raymaekers-Rousseeuw (z-score norm.)  & 0.605 & 0.922 & 0.635     & $< 0.001$ & 0.054 \\
Raymaekers-Rousseeuw (robust scaling) & 0.830 & 0.948 & 0.637     & $< 0.001$ & 0.085 \\
invariant                             & 0.948 & 0.231 & $< 0.001$ & $< 0.001$ & 0.184 \\
robust invariant                      & 0.797 & 0.182 & 0.352     & $< 0.001$ & 0.397 \\
\bottomrule
\end{tabular}
\end{center}
\end{table}

\section*{References}\label{references}
\addcontentsline{toc}{section}{References}

\phantomsection\label{refs}
\begin{CSLReferences}{1}{0}
\bibitem[\citeproctext]{ref-Alfons2021-kc}
Alfons, Andreas. 2021. {``{robustHD}: An {R} Package for Robust
Regression with High-Dimensional Data.''} \emph{J. Open Source Softw.} 6
(67): 3786. \url{https://doi.org/10.21105/joss.03786}.

\bibitem[\citeproctext]{ref-Anderson1952-gz}
Anderson, T W, and D A Darling. 1952. {``Asymptotic Theory of Certain
{`Goodness of Fit'} Criteria Based on Stochastic Processes.''}
\emph{Annals of Mathematical Statistics} 23 (2): 193--212.
\url{https://doi.org/10.1214/aoms/1177729437}.

\bibitem[\citeproctext]{ref-Anscombe1983-nz}
Anscombe, F J, and William J Glynn. 1983. {``Distribution of the
Kurtosis Statistic B2 for Normal Samples.''} \emph{Biometrika} 70 (1):
227--34. \url{https://doi.org/10.1093/biomet/70.1.227}.

\bibitem[\citeproctext]{ref-Cramer1928-rc}
Cramér, Harald. 1928. {``On the Composition of Elementary Errors.''}
\emph{Scand. Actuar. J.} 1928 (1): 13--74.
\url{https://doi.org/10.1080/03461238.1928.10416862}.

\bibitem[\citeproctext]{ref-DAgostino1990-kp}
D'Agostino, Ralph B, and Albert Belanger. 1990. {``A Suggestion for
Using Powerful and Informative Tests of Normality.''} \emph{Am. Stat.}
44 (4): 316--21. \url{https://doi.org/10.2307/2684359}.

\bibitem[\citeproctext]{ref-De-Cock2011-jf}
De Cock, Dean. 2011. {``Ames, Iowa: Alternative to the Boston Housing
Data as an End of Semester Regression Project.''} \emph{J. Stat. Educ.}
19 (3). \url{https://doi.org/10.1080/10691898.2011.11889627}.

\bibitem[\citeproctext]{ref-Gorman2014-eo}
Gorman, Kristen B, Tony D Williams, and William R Fraser. 2014.
{``Ecological Sexual Dimorphism and Environmental Variability Within a
Community of Antarctic Penguins (Genus Pygoscelis).''} \emph{PLoS One} 9
(3): e90081. \url{https://doi.org/10.1371/journal.pone.0090081}.

\bibitem[\citeproctext]{ref-Huber1981-su}
Huber, Peter J. 1981. \emph{Robust Statistics}. John Wiley \& Sons.
\url{https://doi.org/10.1002/0471725250}.

\bibitem[\citeproctext]{ref-Jarque1980-hw}
Jarque, Carlos M, and Anil K Bera. 1980. {``Efficient Tests for
Normality, Homoscedasticity and Serial Independence of Regression
Residuals.''} \emph{Econ. Lett.} 6 (3): 255--59.
\url{https://doi.org/10.1016/0165-1765(80)90024-5}.

\bibitem[\citeproctext]{ref-Kuhn2019-kt}
Kuhn, Max, and Kjell Johnson. 2019. \emph{Feature Engineering and
Selection: A Practical Approach for Predictive Models}. Chapman \&
Hall/CRC Data Science Series. Chapman; Hall/CRC.
\url{https://doi.org/10.1201/9781315108230}.

\bibitem[\citeproctext]{ref-Loprinzi1994-cd}
Loprinzi, C L, J A Laurie, H S Wieand, J E Krook, P J Novotny, J W
Kugler, J Bartel, M Law, M Bateman, and N E Klatt. 1994. {``Prospective
Evaluation of Prognostic Variables from Patient-Completed
Questionnaires. North Central Cancer Treatment Group.''} \emph{J. Clin.
Oncol.} 12 (3): 601--7. \url{https://doi.org/10.1200/JCO.1994.12.3.601}.

\bibitem[\citeproctext]{ref-Von_Mises1928-ef}
Mises, Richard von. 1928. \emph{Wahrscheinlichkeit Statistik Und
Wahrheit}. Schriften Zur Wissenschaftlichen Weltauffassung.
Springer-Verlag Berlin, Heidelberg.
\url{https://doi.org/10.1007/978-3-662-36230-3}.

\bibitem[\citeproctext]{ref-Raymaekers2024-zf}
Raymaekers, Jakob, and Peter J Rousseeuw. 2024. {``Transforming
Variables to Central Normality.''} \emph{Mach. Learn.} 113 (8):
4953--75. \url{https://doi.org/10.1007/s10994-021-05960-5}.

\bibitem[\citeproctext]{ref-Shapiro1965-zd}
Shapiro, S S, and M B Wilk. 1965. {``An Analysis of Variance Test for
Normality (Complete Samples).''} \emph{Biometrika} 52 (3/4): 591--611.
\url{https://doi.org/10.2307/2333709}.

\end{CSLReferences}

\end{document}
